/anaconda3/envs/HW1_Template/bin/python /Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/tests/CSVtests.py

===== Testing CSV Load Good =====
Created table = CSVDataTable: config data = 
{
  "table_name": "people",
  "connect_info": {
    "directory": "/Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/Data/Baseball",
    "file_name": "People.csv"
  },
  "key_columns": null,
  "debug": true
}
Some Rows: = 
     playerID birthYear birthMonth birthDay birthCountry birthState      birthCity deathYear deathMonth deathDay  ...  nameLast        nameGiven weight height bats throws       debut   finalGame   retroID    bbrefID
0   aardsda01      1981         12       27          USA         CO         Denver                                ...   Aardsma      David Allan    215     75    R      R  2004-04-06  2015-08-23  aardd001  aardsda01
1   aaronha01      1934          2        5          USA         AL         Mobile                                ...     Aaron      Henry Louis    180     72    R      R  1954-04-13  1976-10-03  aaroh101  aaronha01
2   aaronto01      1939          8        5          USA         AL         Mobile      1984          8       16  ...     Aaron       Tommie Lee    190     75    R      R  1962-04-10  1971-09-26  aarot101  aaronto01
3    aasedo01      1954          9        8          USA         CA         Orange                                ...      Aase   Donald William    190     75    R      R  1977-07-26  1990-10-03  aased001   aasedo01
4    abadan01      1972          8       25          USA         FL     Palm Beach                                ...      Abad    Fausto Andres    184     73    L      L  2001-09-10  2006-04-13  abada001   abadan01
5         ***       ***        ***      ***          ***        ***            ***       ***        ***      ***  ...       ***              ***    ***    ***  ***    ***         ***         ***       ***        ***
6         ***       ***        ***      ***          ***        ***            ***       ***        ***      ***  ...       ***              ***    ***    ***  ***    ***         ***         ***       ***        ***
7    zupofr01      1939          8       29          USA         CA  San Francisco      2005          3       25  ...      Zupo     Frank Joseph    182     71    L      R  1957-07-01  1961-05-09  zupof101   zupofr01
8   zuvelpa01      1958         10       31          USA         CA      San Mateo                                ...   Zuvella             Paul    173     72    R      R  1982-09-04  1991-05-02  zuvep001  zuvelpa01
9   zuverge01      1924          8       20          USA         MI        Holland      2014          9        8  ...  Zuverink           George    195     76    R      R  1951-04-21  1959-06-15  zuveg101  zuverge01
10  zwilldu01      1888         11        2          USA         MO      St. Louis      1978          3       27  ...  Zwilling  Edward Harrison    160     66    L      L  1910-08-14  1916-07-12  zwild101  zwilldu01
11   zychto01      1990          8        7          USA         IL          Monee                                ...      Zych    Anthony Aaron    190     75    R      R  2015-09-04  2017-08-19  zycht001   zychto01

[12 rows x 24 columns]

Process finished with exit code 0


===== Testing CSV Find by Primary Key =====
Data =  {'playerID': 'aardsda01', 'yearID': '2004', 'stint': '1', 'teamID': 'SFN'}

Process finished with exit code 0


===== Testing CSV Find by Primary Key with no field list =====
Data =  {'playerID': 'aardsda01', 'yearID': '2004', 'stint': '1', 'teamID': 'SFN', 'lgID': 'NL', 'G': '11', 'AB': '0', 'R': '0', 'H': '0', '2B': '0', '3B': '0', 'HR': '0', 'RBI': '0', 'SB': '0', 'CS': '0', 'BB': '0', 'SO': '0', 'IBB': '0', 'HBP': '0', 'SH': '0', 'SF': '0', 'GIDP': '0'}

Process finished with exit code 0


===== Testing CSV Find by Template Good =====
Data =  [{'playerID': 'adamsbo01', 'birthYear': '1901', 'birthState': 'MA', 'birthCity': 'Holyoke', 'nameLast': 'Adams'}, {'playerID': 'adamsge01', 'birthYear': '1855', 'birthState': 'MA', 'birthCity': 'Worcester', 'nameLast': 'Adams'}, {'playerID': 'adamsgl01', 'birthYear': '1947', 'birthState': 'MA', 'birthCity': 'Northbridge', 'nameLast': 'Adams'}]

Process finished with exit code 0


===== Testing CSV Delete by Primary Key Good =====
Number of Rows Deleted =  1

Process finished with exit code 0


===== Testing CSV Delete by Template Good =====
Number of Rows Deleted =  3

Process finished with exit code 0


===== Testing CSV Update by Primary Key Good =====
Number of Rows Updated =  1

Process finished with exit code 0


===== Testing CSV Update by Primary Key Bad (Duplicate Key Values) =====
Traceback (most recent call last):
  File "/Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/tests/CSVtests.py", line 256, in <module>
    t8_update_by_primary_key()
  File "/Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/tests/CSVtests.py", line 156, in t8_update_by_primary_key
    result = table.update_by_key(key_fields, new_values)
  File "/Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/src/CSVDataTable.py", line 283, in update_by_key
    raise Exception("Error when update: duplicate primary key fields found")
Exception: Error when update: duplicate primary key fields found

Process finished with exit code 1


===== Testing CSV Update by Template Good =====
Number of Rows Updated =  8

Process finished with exit code 0


===== Testing CSV Update by Template Bad (Duplicate Key Values) =====
Traceback (most recent call last):
  File "/Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/tests/CSVtests.py", line 258, in <module>
    t10_update_by_template()
  File "/Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/tests/CSVtests.py", line 194, in t10_update_by_template
    result = table.update_by_template(template, new_values)
  File "/Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/src/CSVDataTable.py", line 315, in update_by_template
    raise Exception("Error when update: duplicate primary key fields found")
Exception: Error when update: duplicate primary key fields found

Process finished with exit code 1


===== Testing CSV Insert Good =====

Process finished with exit code 0


===== Testing CSV Insert Bad (Invalid Columns) =====
Traceback (most recent call last):
  File "/Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/tests/CSVtests.py", line 258, in <module>
    t12_insert()
  File "/Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/tests/CSVtests.py", line 226, in t12_insert
    table.insert(new_record)
  File "/Users/jingjing/Documents/Coms_4111/HW_Assignments/HW1_Template/src/CSVDataTable.py", line 335, in insert
    raise Exception("Error when insert: new record does not match with the key fields.")
Exception: Error when insert: new record does not match with the key fields.

Process finished with exit code 1


===== Testing CSV Find by Primary Key after insertion =====
Data =  [{'playerID': 'inserttest01', 'birthYear': '2019', 'birthMonth': '', 'birthDay': '', 'birthCountry': '', 'birthState': '', 'birthCity': 'New York', 'deathYear': '', 'deathMonth': '', 'deathDay': '', 'deathCountry': '', 'deathState': '', 'deathCity': '', 'nameFirst': '', 'nameLast': '', 'nameGiven': '', 'weight': '', 'height': '', 'bats': '', 'throws': '', 'debut': '', 'finalGame': '', 'retroID': '', 'bbrefID': ''}]

Process finished with exit code 0
